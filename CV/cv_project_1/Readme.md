# Определение возраста покупателей по фото

([Тетрадка с проектом](https://github.com/Vanarty/Yandex-Projects/blob/main/CV/cv_project_1/cv_project_1.ipynb))

* Автор проекта - *Иванов Артём Юрьевич*
* vanarty@yandex.ru

Сетевой супермаркет «Хлеб-Соль» внедряет систему компьютерного зрения для обработки фотографий покупателей. Фотофиксация в прикассовой зоне поможет определять возраст клиентов, чтобы:
- Анализировать покупки и предлагать товары, которые могут заинтересовать покупателей этой возрастной группы;
- Контролировать добросовестность кассиров при продаже алкоголя.

Необходимо построить модель, которая по фотографии определит приблизительный возраст человека. Заказчик предоставил набор фотографий людей с указанием возраста.

**План выполнения:**
- загрузить данные;
- провести исследовательский анализ набора фотографий;
- подготовить данные к обучению;
- обучить нейронную сеть и рассчитать её качество по метрике **MAE**. Требования Заказчика, чтобы **MAE не выше 8**.

## В ходе исследования было выявлено:
1. В данных **нет явных Nan-пропусков**. Все фото размечены в допустимом диапазоне человеческого возраста (**1 - 100 лет**);
2. Данные представлены **небольшим количеством данных**, всего **7591 фотографий**. Предалагается аугментация данных или примененеие предобученного `бэкбона` например на наборе `ImageNet`;
3. Группы пользователей **в разной возрастной категории** представлены в данных **неравномерно**. Например люди в возрасте **старше 60 лет** в данных представлены **редко**, в отличие например от средней категории (**20 - 41 год**) или детей в возрасте **до 10 лет**. Модель скорее всего недостаточно обучится распознавать пожилых людей в диапазоне **60 - 100 лет**;
4. В данных присутствуют фото людей разного характера, которые в основном могут негативно повлиять на качество модели (**качество фото, позиция лица, дальний план, наличие дополнительных или посторонних предметов** и т.д.).
   
## Выводы:
В проекте была использована предварительно обученная на данных `ImageNet` модель на основе свёрточной сети **ResNet50**. 
Выходной модели был заменен на слой **GlobalAveragePooling2D** и полносвязный слой с одним нейроном (функция активации -**relu** в соотвествии с задачей **регрессии**). 

При обучении на 8 эпохах удалось достичь качества модели по метрике **MAE** - **6.496** на валидационной выборке, что лучше требуемого Заказчиком уровня (**не более 8**).

Характеристики модели и заданные параметры:
- `модель` - **ResNet50**, предобученная на **ImageNet**; 
- `аугментация` - **без аугментации**;
- размер `батча` - **32 изображения**;
- `learning_rate` оптимизатора `Adam` - **0.0004**;
- `количество эпох` - **8**. 

## Рекомендации к улучшению проекта:
- применить аугментацию к данным;
- использовать другую модель;
- очистить данные от фото, которые могут внести смещения при обучении модели. На этапе EDA такие фотографии и проблемы были выявлены и объяснены;
- попробовать применить к задаче готовые решения.
