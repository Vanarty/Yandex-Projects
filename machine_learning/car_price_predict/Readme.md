# Предсказание стоимости авто

([Тетрадка с проектом](https://github.com/Vanarty/Yandex-Projects/blob/main/machine_learning/car_price_predict/car_price_predict.ipynb))

* Автор проекта - *Иванов Артём Юрьевич*
* vanarty@yandex.ru

Сервис по продаже автомобилей с пробегом «Не бит, не крашен» разрабатывает приложение для привлечения новых клиентов. В нём можно быстро узнать рыночную стоимость своего автомобиля. В вашем распоряжении исторические данные: технические характеристики, комплектации и цены автомобилей. Вам нужно построить модель для определения стоимости. 

Заказчику важны:

- качество предсказания;
- скорость предсказания;
- время обучения.

## Было выполнено:
1. загружены данные, проведена начальная предобработка (удалены объекты с аномально низкими значениями целевого признака, обработаны явные и неявные дубликаты);
2. данные предварительно разбиты на обучающую, валидационную и тестовую выборки;
3. проведен анализ данных (EDA-исследование);
4. **проведено отдельное исследование пропущенных значенийи**, с последующей их обработкой;
5. **написан собственный класс для препроцессинга данных** с использованием **`Pipeline`**;
6. с предварительным подбором гиперпараметров обучены **5 моделей** на основе `'деревьев'`: **DecisionTree**, **'RandomForest', 'XGBoost', 'CatBoost', 'LightGBM'**. 7. оценено время обучения и предсказания для каждой модели;
8. выбрана лучшая модель по результатам метрики **RMSE** и времени обучения и предсказания;
9. лучшая модель оценена на тестовой (отложенной) выборке;
10. определены наиболее важные признаки для предсказания стоимости авто;
11. даны рекомендации для возможного улучшения работы.

## Выводы:
В связи с тем, что у каждой модели собственные гиперпараметры и время их нахождения напрямую зависят от диапазона и масштаба подбора, время обучения моделей оценивалось только на подобранных заранее значениях гиперпараметров для более честного сравнения.

Лучшей моделью по условиям задачи бизнеса можно считать **`RandomForestRegressor`**. Она имеет достаточно хороший показатель метрики **RMSE** (**1608.34**) при достаточном быстродействии в условиях зашумленных данных. Все остальные модели в совокупности показали себя хуже.

Признаки `'год регистрации'` и `'мощность'` имеют самое высокое значение для предсказания стоимости авто.

## Рекомендации:
1. Понять природу пропусков. Запросить информацию у специалистов, ответственных за базу данных о возможных причинах пропусков. 
2. Реализовать (подобрать или разработать) быстрые многомерные методы восстановления пропусков, основанные на имеющихся данных. Чаще всего многомерные методы восстановления пропусков позволяют достичь более высокого качества моделей на предсказании.
3. Проверить форму заполнения объявлений о продаже на наличие обязательных требований к заполнению всех полей. Так же по возможности на этапе формирования объявления задать минимальные и максимальные граничные значения для заполняемых данных.
4. Проверить, действительно ли пользователи не загружают фото, либо существует какая-либо ошибка на стороне клиента или сервера. Например люди просто не могут загрузить фото из-за техничесокй ошибки, или в базе данных некорректно подсчитывается и хранится данный параметр.
5. Хранить информацию о месяце регистрации авто скорее всего избыточно. Тем более признак не несет в себе какую-либо полезную информацию. 
