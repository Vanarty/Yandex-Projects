# Отток клиентов

([Тетрадка с проектом](https://github.com/Vanarty/Yandex-Projects/blob/main/machine_learning/bank_customer_churn/bank_customer_churn.ipynb))

* Автор проекта - *Иванов Артём Юрьевич*
* vanarty@yandex.ru

Из «Бета-Банка» стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.

Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Нам предоставлены исторические данные о поведении клиентов и расторжении договоров с банком. 

Построим несколько моделей с предельно большим значением *F1*-меры. Чтобы сдать проект успешно, нужно довести метрику до 0.59. Проверим *F1*-меру на тестовой выборке.

Дополнительно измерим метрику *AUC-ROC*, сравнивая её значение с *F1*-мерой.

Источник данных: [https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling](https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling)

## Выводы:
1. Так как метрика `точности` (**Accuracy**) зависима от баланса классов, значения метрик **F1-меры**, которая отражает сбалансированность точности и полноты предсказаний модели (метрик `recall` и `precision`), и **ROC-AUC**, характеризующей насколько модель правильно и полно определяет целевой класс (`1`) среди всех истиноположительных объектов при наименьшей ошибке I-го рода (ложноположительном прогнозе среди лояльных клиентов), являются более весомыми и значимыми в случае несбалансированности классов. 
2. Балансировка классов с помощью **апсемплинга** (простого и с использованием **Smote**) дала прирост в качестве прогнозирования моделей по метрике **F1** и позволила достичь хороших показателей на **моделях случайного леса** и **решающего дерева**. Подбор **порога** классификатора так же позволил увеличить показатели двух метрик из трех (**F1 меру** и **ROC-AUC**).
3. **Логистическая регрессия** показала *наихудший результат* во всех случаях. Возможно целевой признак имеет более сложную и нелинейную связь с остальными признаками.
4. После апсемплинга видно что графики "растягиваются" и оптимальные пороги смещаются вправо.
5. Наилучшими признаками для прогнозирвоания оттока можно считать `['Age']`, `['Num of products']`, `['Gender']`, `['Geography']`, `['CreditScore']`, что так же хорошо видно на графиках на этапе *EDA*.
6. Параметр **random_state**, который задает псевдослучайность в каждом случае так же влияет на значения метрик (в пределах определенной погрешности), что в свою очередь может сказаться на итогах выбора лучшей модели. Например при подборе нужного параметра **random_state** так же можно было бы достичь значения метрики **F1** в **0.59** модели решающего дерева на тестовой выборке.

## Рекомендации:
- выяснить причину пропусков по колонке `['Tenure']` и устранить;
- подобрать нелинейную модель, которая сможет улучшить качество и предсказания целевого признака на несбалансированных данных. 
