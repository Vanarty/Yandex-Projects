# Оценка риска ДТП

([Тетрадка с проектом](https://github.com/Vanarty/Yandex-Projects/blob/main/machine_learning/car_accident_risk/car_accident_risk.ipynb))

* Автор проекта - *Иванов Артём Юрьевич*
* vanarty@yandex.ru

Необходимо создать систему, которая могла бы оценить риск ДТП по выбранному маршруту движения. Под риском понимается вероятность ДТП с любым повреждением транспортного средства. Как только водитель забронировал автомобиль, сел за руль и выбрал маршрут, система должна оценить уровень риска. Если уровень риска высок, водитель увидит предупреждение и рекомендации по маршруту.
Идея создания такой системы находится в стадии предварительного обсуждения и проработки. Чёткого алгоритма работы и подобных решений на рынке ещё не существует. Текущая задача — понять, возможно ли предсказывать ДТП, опираясь на исторические данные одного из регионов.

**Идея решения задачи от заказчика:** 
1. Создать модель предсказания ДТП (целевое значение — **at_fault (виновник)** в таблице **parties**)
 - Для модели выбрать тип виновника — только машина (**car**).
 - Выбрать случаи, когда ДТП привело к любым повреждениям транспортного средства, **кроме типа SCRATCH (царапина)**.
 - Для моделирования ограничиться данными за **2012 год**.
 - Обязательное условие — учесть **фактор возраста автомобиля**.
2. На основе модели исследовать основные факторы ДТП.
3. Понять, помогут ли результаты моделирования и анализ важности факторов ответить на вопросы:
 - Возможно ли создать адекватную систему оценки водительского риска при выдаче авто?
 - Какие ещё факторы нужно учесть?
 - Нужно ли оборудовать автомобиль какими-либо датчиками или камерой?

Заказчик предлагает поработать с базой данных по происшествиям и сформировать свои идеи создания такой системы. 

## Было выполнено:
1. В данном проекте была обучена модель ML для каршеринговой компании, которая могла бы оценить b предсказать риск ДТП по совокупности факторов.
2. Исследованы представленные Заказчиком данные, проведен статистический анализ некоторых факторов с составлением списка других подобных задач для дальнейшего исследования.
3. Подготовлены и обработаны данные для анализа за 2012 год. 
4. Обучены модели классического машинного обучения (логистическая регрессия, случайный лес) и бустинг-модели.

## Выводы:
Бустинг-модели показали лучшие результаты по сравнению с бейзлайн-моделью, а так же моделью логистической регрессии. Для деплоя предлагается модель **XGBClassifier**, показывающая лучший результат на кросс-валидации.

Наибольший вклад в предсказание положительного класса (1) целевого признака `'at_fault'` вносят следующие признаки: 
- 'county_city_location' (номер географического района);
- 'party_drug_physical' (физическое состояние водителя с учётом принятых лекарств) 
- 'vehicle_type' (тип кузова).

## Рекомендации:
- для отслеживания физического состояния водителя установить в салон камеру, направленное на его лицо. Разработать модель распознавания по лицу усталости, частого моргания, возможно других симптомов, указывающих например на прием сильнодействующих лекарств или алкоголя;
- обязать перед поездкой водителя внести маршрут или район передвижения для отслеживания потенциально опасных районов, где повышен риск попасть в ДТП;
- так же дополнительно предлагается отслеживать **пол**, **возраст**, **стаж** водителя и **цель каршеринга** ('семейная поездка', 'одиночный туризм', 'срочная встреча' и т.д.). Такие данные вполне могут улучшить качество модели в будущем при сборе достаточного количества дополнительных данных.
