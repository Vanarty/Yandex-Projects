# Выбор локации для скважины

([Тетрадка с проектом](https://github.com/Vanarty/Yandex-Projects/blob/main/machine_learning/oil_well_location/oil_well_location.ipynb))

* Автор проекта - *Иванов Артём Юрьевич*
* vanarty@yandex.ru

Допустим, вы работаете в добывающей компании «ГлавРосГосНефть». Нужно решить, где бурить новую скважину.

Вам предоставлены пробы нефти в трёх регионах: в каждом 10 000 месторождений, где измерили качество нефти и объём её запасов. Постройте модель машинного обучения, которая поможет определить регион, где добыча принесёт наибольшую прибыль. Проанализируйте возможную прибыль и риски техникой *Bootstrap.*

Шаги для выбора локации:

- В избранном регионе ищут месторождения, для каждого определяют значения признаков;
- Строят модель и оценивают объём запасов;
- Выбирают месторождения с самым высокими оценками значений. Количество месторождений зависит от бюджета компании и стоимости разработки одной скважины;
- Прибыль равна суммарной прибыли отобранных месторождений.

## Было выполнено:
**1.** Проведено исследование данных о качестве нефти (признаки) и её запасах (целевой признак) по трем регионам. Выявлены неявные дубликаты, которые были удалены, построены графики распределения признаков. 

**Наблюдения по Региону №1:**

- только признак `['f2']` имеет нормальное распределение. Остальные признаки имеют несколько пиков в значениях;
- целевой признак `['product']` имеет определенную (видимую) положительную корреляцию с признаком `['f2']`;
- при определенных граничных значениях признаков `['f0']` и `['f1']` диапазон значений целевого признака `['product']` сдвигается;
- признаки `['f0']` и `['f1']` имеют интересную взаимную зависимость. Возможно это может говорить о синтетичности данных.

**Наблюдения по Региону №2:**

- графики распределения по второму региону значительно различаются с остальными регионами, что ещё раз может подтверждать синтетическое происхождение данных;
- только признак `['f1']` имеет нормальное распределение. Признак `['f0']` имеет два пиков в значениях; 
- все 
- целевой признак `['product']` имеет строго линейную положительную связь с признаком `['f2']`;
- имеется два пиковых значения признака `['product']` около **0** и **140**.

**Наблюдения по Региону №3:**

- все признаки кроме `['product']` имеют нормальное распределение. Целевой признак имеет несколько пиков в значениях;
- целевой признак `['product']` имеет определенную (видимую) положительную корреляцию с признаком `['f2']`;
- при определенных значениях признаков `['f0']` и `['f1']` диапазон значений целевого признака `['product']` ступенчато изменяется;
- признаки `['f0']`,`['f1']` и `['f2']` не имеют какую-либо взаимную зависимость. 

**2.** Перед обучением моделей линейной регрессии по каждому региону разбили данные на обучающую и валидационную выборки. Признаки, кроме целевого привели к одному масштабу с помощью **StandardScaler**. 

**3.** Обучили модель линейной регрессии на обучающих выборках по каждому региону. Была сформирована общая таблица после предсказания моделей на валидационной выборке каждого региона с оценкой **ошибки MSE**, **стандартным отклонением RMSE**, критерием детерминации **R2**, **средним реальным запасом** нефти и **средним предсказанным запасом** нефти в скважине. Все данные сохранены для дальнейшего расчёта прибыли и рисков.
**Основные выводы по этапу:**

* По *региону №2* модель линейной регрессии предсказала почти 100% результат по объемам запасов нефти на валидационной выборке (метрика *R2 почти равна 1*). Это можно объяснить прямой корреляцией признака `['f2']` с целевым, отмеченной на на этапе EDA. Прогнозируемый средний запас объемов нефти по региону №2 самый низкий из всех и составляет *69 тыс.бар*.
* По *регионам №1* и *№3* можно наблюдать *больший прогнозируемый объем запасов*, чем в *регионе №2*, но и ошибка значительно выше.
* Все модели имеют метрику *R2* > 0, что говорит об адекватности их прогнозирования в сравнении с константными моделями, предсказывающими среднее значение по каждой выборке.
* *Регион №3* имеет самый большой прогнозируемый средний запас объемов нефти (*95,1 тыс.бар.*), на втором месте *регион №1* (*92,6 тыс.бар.*).

**4.** Расчитана **максимальная валовая прибыль** по трем регионам при бурении 200 скважин с самым высоким запасом нефти **без** использования техники **Bootstrap**:
* **Наибольшую валовую прибыль** при разработке 200 скважин можно ожидать **в первом регионе**, которая составит **3,254 млрд.руб**. Такие показатели можно принять за максимально возможные исходя из текущих имеющихся данных со всех месторождений во всех трёх регионах.

**5.** Расчитана **средняя валовая прибыль** при бурении 200 скважин с максимальным запасом нефти для каждого региона техникой **Bootstrap**, **доверительные интервалы** и **риски**. Сформирована общая таблица с результатами.
## Выводы:
Бустинг-модели показали лучшие результаты по сравнению с бейзлайн-моделью, а так же моделью логистической регрессии. Для деплоя предлагается модель **XGBClassifier**, показывающая лучший результат на кросс-валидации.

**Выводы:**

1. При самом низком среднем уровне запасов (**69 тыс.бар.**) **Регион №2** имеет самые **низкий риск убытков** (всего **0.6%**) при средней прибыли в **527 704.10 тыс.руб.** 95% доверительный интервал по прибыли составил **135 178.25-955 833.52 тыс.руб.**.
2. **Регионы №1** и **№3**  имеют **умеренный и высокий риск убытков**, **6.3%** и **10.4%** соответственно.
3. Так как **Регион №1** имеет потенциал в плане нахождения и разработки 200 скважин, имеющих наибольшие запасы (ожидаемая валовая прибыль по вервому региону при разработке 200 скважин: **3 254 756.68 тыс. руб.**) выбор региона для бурения скважин будет зависить от стратегии компании. Для **минимизации рисков убытков** предпочтителен **Регион №2**, в случае же достижения **максимальной прибыли** при **умеренном риске** рекомендуется к разработке **Регион №1**.
